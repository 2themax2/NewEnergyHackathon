
<div class="dashboard-container container">
  <header class="dashboard-header fade-in">
    <h1>Energy Overview</h1>
    <p class="subtitle">Real-time insights into your energy consumption and generation.</p>
  </header>

  <ng-container *ngIf="dashboardData$ | async as data; else loadingOrError">
    <section class="summary-section slide-in-up">
      <h2>Quick Summary</h2>
      <div class="summary-grid">
        <app-energy-widget [metric]="data.summary.totalConsumption" widgetType="summary"></app-energy-widget>
        <app-energy-widget [metric]="data.summary.renewableGeneration" widgetType="summary"></app-energy-widget>
        <app-energy-widget [metric]="data.summary.gridImport" widgetType="summary"></app-energy-widget>
        <app-energy-widget [metric]="data.summary.carbonFootprint" widgetType="summary"></app-energy-widget>
      </div>
    </section>

    <section class="detailed-metrics-section slide-in-up" style="animation-delay: 0.2s;">
      <h2>Detailed Metrics</h2>
      <div class="detailed-grid">
        <app-energy-widget
          *ngFor="let metric of data.detailedMetrics; trackBy: trackByMetricId"
          [metric]="metric"
          widgetType="detail">
        </app-energy-widget>
      </div>
    </section>

  </ng-container>

  <ng-template #loadingOrError>
    <div *ngIf="!(dashboardData$ | async) && !error" class="loading-state text-center">
      <i class="fas fa-spinner fa-spin fa-3x"></i>
      <p>Loading energy data...</p>
    </div>
    <div *ngIf="error" class="error-state card text-center">
      <i class="fas fa-exclamation-triangle fa-3x text-danger"></i>
      <p>{{ error }}</p>
      <button class="btn btn-primary" (click)="ngOnInit()">Retry</button>
    </div>
  </ng-template>
</div>
